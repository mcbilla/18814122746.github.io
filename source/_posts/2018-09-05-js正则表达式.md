---
title: js正则表达式
date: 2018-09-05 16:09:00
categories:
  - 前端
  - javascript
tags:
  - javascript
---

> 正则表达式具有复杂字符串搜寻，替换，验证等强大功能，最近接触了 js 的正则表达式顺便学习了一下基础，在这里记录一下学习相关资料。

<!--more-->

## 概述

下面有两篇文章较为详细地介绍了 js 正则表达式的基础内容和一些实践例子，先直接贴链接，以后有时间再详细介绍内容：

[JavaScript 正则表达式（实例）](https://www.jianshu.com/p/67e3bcafdd46)

[玩转JavaScript正则表达式](http://imweb.io/topic/56e804ef1a5f05dc50643106)

## 补充

### RexExp 对象
#### RexExp 对象是什么
RexExp 对象是一个全局对象，用于存储模式匹配期间找到的对象。

* RexExp 对象的写法是 **RexExp.$n**，RexExp.$1，RexExp.$2......RexExp.$99，一共可以存储 99 个对象。
* 每次在调用 **非全局的**（没有 g 修饰）文本匹配方法，例如`RegExp.prototype.exec(str)`、 `String.prototype.match(reg)` 或者 `String.prototype.replace(reg)` 时，当找到匹配项时，***RexExp.$1 对应匹配项中第一个括号中的内容，RexExp.$2 对应匹配项中第二个括号中的内容，以此类推***。也就是说 RexExp 对象只储存括号里面的内容。
* 每次找到匹配项都会 ***更新所有 RexExp 对象***，也就是说 RexExp.$1，RexExp.$2......这些对象全都会被更新。

这么说可能有点抽象，看下下面的例子就明白了。

```
var reg1 = /\d(\w)/;
var reg2 = /\d(\w)/g;
var str = '$1a2b3c4d5e';

//非全局匹配
var rs1 = str.match(reg1)
console.log(rs1) //["1a", "a", index: 1, input: "$1a2b3c4d5e"]

//全局匹配
var rs2 = str.match(reg2)
console.log(rs2) //["1a", "2b", "3c", "4d", "5e"]
```

在上面非全局匹配中返回的数组信息有

* 第一个元素 1a 是找到的第一个匹配项。
* 第二个元素对应 RegExp.$1 存储的内容。因为正则表达式`\d(\w)` 有一个括号 `(\w)`，对应匹配项 1a 里面的 a，所以 a 会被存储在 RegExp.$1 中。
* index: 1 表示找到匹配项首字符的位置。
* input: "1a2b3c4d5e" 表示输入的查找字符串。

但是在全局匹配返回的数组里面，就只有所有的匹配项信息，RegExp对象、index 和 input 这些信息都没有保存。

#### RexExp 对象怎么用
那么这些 RexExp 对象有什么作用呢？其中最重要的一个作用是用子匹配项 RexExp.$n 来替换原来的文本内容。比如我们想把 '2016-11-25' 变成 '11/25/2016'，这时候用 RexExp 对象就会非常方便

```
'2016-11-25'.replace(/(\d{4})-(\d{2})-(\d{2})/g,'$2/$3/$1') //'11/25/2016'
```

## 例子
下面收集了在工作中常用到的一些正则表达式的例子，在这里记录一下以供日后查阅
### 控制输入框金额的正确性
思路是通过动态修改输入框的内容来控制输入金额的合法性，这里的合法性包括

* 输入的必须数字或者小数点.
* 整数部分不能是0开头的两位以上数字
* 小数部分不能超过两位数字
* 不能包含两个以上小数点

做法是输入框绑定动态输入事件，每次输入内容时候都把内容传进来检查一遍，如果存在不合法的地方进行替换修改，最后把检查完的内容返回输入框显示。这里假设传进来的内容是 `value`，代码如下：

```
    var regStrs = [
      ['^0(\\d+)$', '$1'], //禁止录入整数部分两位以上，但首位为0
      ['[^\\d\\.]+$', ''], //禁止录入任何非数字和点
      ['\\.(\\d?)\\.+', '.$1'], //禁止录入两个以上的点
      ['^(\\d+\\.\\d{2}).+', '$1'] //禁止录入小数点后两位以上
    ]
    for (var i = 0; i < regStrs.length; i++) {
      var reg = new RegExp(regStrs[i][0]);
      value = value.replace(reg, regStrs[i][1]);
    }
```